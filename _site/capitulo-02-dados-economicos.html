<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>capitulo-02-dados-economicos – tiagolafonso.github.io</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">tiagolafonso.github.io</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-dados-economicos-cap" id="toc-sec-dados-economicos-cap" class="nav-link active" data-scroll-target="#sec-dados-economicos-cap">Dados Económicos</a>
  <ul class="collapse">
  <li><a href="#sec-tipos-dados" id="toc-sec-tipos-dados" class="nav-link" data-scroll-target="#sec-tipos-dados">Tipos de dados</a>
  <ul class="collapse">
  <li><a href="#dados-quantitativos" id="toc-dados-quantitativos" class="nav-link" data-scroll-target="#dados-quantitativos">Dados Quantitativos</a></li>
  <li><a href="#dados-qualitativos" id="toc-dados-qualitativos" class="nav-link" data-scroll-target="#dados-qualitativos">Dados qualitativos</a></li>
  </ul></li>
  <li><a href="#sec-estrutura-dados" id="toc-sec-estrutura-dados" class="nav-link" data-scroll-target="#sec-estrutura-dados">Estrutura de dados</a></li>
  <li><a href="#sec-fontes-dados" id="toc-sec-fontes-dados" class="nav-link" data-scroll-target="#sec-fontes-dados">Fontes de dados</a></li>
  <li><a href="#sec-preparar-dados" id="toc-sec-preparar-dados" class="nav-link" data-scroll-target="#sec-preparar-dados">Preparar os dados</a>
  <ul class="collapse">
  <li><a href="#recolher-dados" id="toc-recolher-dados" class="nav-link" data-scroll-target="#recolher-dados">Recolher dados</a></li>
  <li><a href="#limpeza-de-dados" id="toc-limpeza-de-dados" class="nav-link" data-scroll-target="#limpeza-de-dados">Limpeza de dados</a></li>
  </ul></li>
  <li><a href="#sec-calculos" id="toc-sec-calculos" class="nav-link" data-scroll-target="#sec-calculos">Cálculos</a></li>
  <li><a href="#sec-graficos" id="toc-sec-graficos" class="nav-link" data-scroll-target="#sec-graficos">Gráficos</a>
  <ul class="collapse">
  <li><a href="#preparar-dados" id="toc-preparar-dados" class="nav-link" data-scroll-target="#preparar-dados">Preparar dados</a></li>
  <li><a href="#gráficos-com-a-função-plot" id="toc-gráficos-com-a-função-plot" class="nav-link" data-scroll-target="#gráficos-com-a-função-plot">Gráficos com a função <code>plot</code></a></li>
  <li><a href="#gráficos-com-ggplot2" id="toc-gráficos-com-ggplot2" class="nav-link" data-scroll-target="#gráficos-com-ggplot2">Gráficos com <code>ggplot2</code></a></li>
  <li><a href="#gráficos-com-plotly" id="toc-gráficos-com-plotly" class="nav-link" data-scroll-target="#gráficos-com-plotly">Gráficos com <code>plotly</code></a></li>
  <li><a href="#gráficos-de-barras" id="toc-gráficos-de-barras" class="nav-link" data-scroll-target="#gráficos-de-barras">Gráficos de barras</a></li>
  <li><a href="#gráficos-de-linhas" id="toc-gráficos-de-linhas" class="nav-link" data-scroll-target="#gráficos-de-linhas">Gráficos de linhas</a></li>
  <li><a href="#gráficos-de-box-plot" id="toc-gráficos-de-box-plot" class="nav-link" data-scroll-target="#gráficos-de-box-plot">Gráficos de box plot</a></li>
  <li><a href="#gráfico-violino" id="toc-gráfico-violino" class="nav-link" data-scroll-target="#gráfico-violino">Gráfico violino</a></li>
  <li><a href="#histograma" id="toc-histograma" class="nav-link" data-scroll-target="#histograma">Histograma</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="sec-dados-economicos-cap" class="level1">
<h1>Dados Económicos</h1>
<p>Os dados são fundamentais para a análise econométrica. Neste capítulo, vamos explorar os diferentes tipos de dados económicos, as suas características específicas e como manipulá-los adequadamente.</p>
<section id="sec-tipos-dados" class="level2">
<h2 class="anchored" data-anchor-id="sec-tipos-dados">Tipos de dados</h2>
<p>Existem dois tipos principais de dados: quantitativos e qualitativos. Os <strong>dados quantitativos</strong> são dados numéricos que podem ser medidos, enquanto os <strong>dados qualitativos</strong> são dados categóricos que não podem ser medidos, mas podem ser classificados.</p>
<section id="dados-quantitativos" class="level3">
<h3 class="anchored" data-anchor-id="dados-quantitativos">Dados Quantitativos</h3>
<p>Os dados quantitativos podem ser subdivididos em dados discretos e dados contínuos.</p>
<ul>
<li>Os <em>dados discretos</em> assumem valores inteiros e contáveis. Por exemplo, o número de filhos, o número de alunos de uma turma, etc.</li>
<li>Os <em>dados contínuos</em> podem assumir qualquer valor dentro de um intervalo. Por exemplo, a altura de uma pessoa, o peso de um objeto ou a temperatura de uma região.</li>
</ul>
<p>Existem dados contínuos mas que são medidos como os discretos. Isto acontece porque muitas vezes utilizamos uma escala de medição que limita a precisão da medida. Por exemplo, a altura de uma pessoa pode ser medida em centímetros, mas muitas vezes é arredondada para o inteiro mais próximo, como 169 cm. Contudo, sabemos que a altura real pode ser 169,2 cm ou 168,888(8) cm.</p>
</section>
<section id="dados-qualitativos" class="level3">
<h3 class="anchored" data-anchor-id="dados-qualitativos">Dados qualitativos</h3>
<p>Os dados qualitativos são dados categóricos que não podem ser medidos, mas podem ser classificados. Existem dois tipos de dados qualitativos: dados nominais e dados ordinais.</p>
<ul>
<li><p>Os <em>dados nominais</em> são dados categóricos que não podem ser ordenados. Exemplos de dados nominais são a cor dos olhos, o estado civil, etc.</p></li>
<li><p>Os <em>dados ordinais</em> são dados categóricos que podem ser ordenados. Exemplos de dados ordinais são o grau de satisfação, a classe social, nível de escolaridade, classe etária, etc.</p></li>
</ul>
</section>
</section>
<section id="sec-estrutura-dados" class="level2">
<h2 class="anchored" data-anchor-id="sec-estrutura-dados">Estrutura de dados</h2>
<ol type="1">
<li><p><strong>Dados seccionais</strong>: dados recolhidos num único momento de tempo. Em termos de numenclatura referimos que <span class="math inline">\(\color{purple}i\)</span> é o número de observações (entidades). Uma entidade pode ser um país, um distrito, uma empresa, um indivíduo.</p>
<table class="caption-top table">
<caption>Tabela 1: Exemplo da estrutura de dados seccionais O id representa as entidades. <em>ID</em>, genericamente, significa identificador. Y,X,W,Z são variáveis.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: center;">Y</th>
<th style="text-align: center;">X</th>
<th style="text-align: center;">W</th>
<th style="text-align: center;">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">…</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
<li><p><strong>Séries temporais</strong>: dados recolhidos ao longo do tempo. <span class="math inline">\(\color{purple}t\)</span> é o número de observações (tempo). Os dados são recolhidos para uma única entidade. As séries temporais podem ter frequência anual, semestral, trimestral, mensal, diária (5 dias úteis ou 7 dias por semana), intradiáriários (horários, minutos, segundos), etc.</p>
<table class="caption-top table">
<caption>Tabela 2: Exemplo da estrutura de séries temporais (dados anuais)</caption>
<thead>
<tr class="header">
<th>time</th>
<th style="text-align: center;">Y</th>
<th style="text-align: center;">X</th>
<th style="text-align: center;">W</th>
<th style="text-align: center;">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2020</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>2021</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>2022</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>2023</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>…</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
<li><p><strong>Dados em painel</strong>: dados recolhidos ao longo do tempo de forma consecutiva e para várias entidades do mesmo tipo. São uma conjugação das características dos dados seccionais e das séries temporais. <span class="math inline">\(\color{purple}i\)</span> é o número de entidades e <span class="math inline">\(\color{purple}t\)</span> é o número de observações (tempo). <span class="math inline">\(\color{purple}N\)</span> é o número de observações do painel <span class="math inline">\(\color{purple}N = i\times t\)</span>.</p>
<table class="caption-top table">
<caption>Tabela 3: Exemplo da estrutura de dados em painel</caption>
<thead>
<tr class="header">
<th>país</th>
<th>ano</th>
<th style="text-align: center;">Y</th>
<th style="text-align: center;">X</th>
<th style="text-align: center;">W</th>
<th style="text-align: center;">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PT</td>
<td>2021</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>PT</td>
<td>2022</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>PT</td>
<td>2023</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>ES</td>
<td>2021</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>ES</td>
<td>2022</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>ES</td>
<td>2023</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
</ol>
<p>Os painéis podem ser:</p>
<ul>
<li><p><em>balanceados</em>: todas as entidades têm o mesmo número de observações.</p></li>
<li><p><em>não balanceados</em>: as entidades têm um número diferente de observações.</p></li>
<li><p><em>macropainel</em>: em que o <span class="math inline">\(\color{purple}t&gt;i\)</span>.</p></li>
<li><p><em>micropainel</em>: em que o <span class="math inline">\(\color{purple}t&lt;i\)</span>.</p></li>
</ul>
<p>Na estrutura de dados em painel a frequência dos dados é a mesma para todas as entidades, sendo que as entidades são todas do mesmo tipo.</p>
<ol start="4" type="1">
<li><strong>Dados espaciais</strong>: dados recolhidos no espaço (e.g.&nbsp;dados geográficos)</li>
</ol>
<ul>
<li>dados vetoriais: dados representados por pontos (exemplo: localização de cidades), linhas (exemplo: estradas) ou polígonos (exemplo: fronteiras de países)</li>
<li><em>dados raster</em> : dados representados por uma grelha de células (exemplo: mapas de calor)</li>
</ul>
</section>
<section id="sec-fontes-dados" class="level2">
<h2 class="anchored" data-anchor-id="sec-fontes-dados">Fontes de dados</h2>
<p>Os dados podem ser classificados em duas categorias: <em>dados primários</em> e <em>dados secundários</em>. Os dados primários são dados que são recolhidos diretamente pelo investigador (por exemplos: questionários, entrevistas, ou mesmo através de experiências). Os dados secundários são dados que são recolhidos por outra pessoa ou organização (por exemplo: Bando de Portugal, INE, Eurostat, Banco Mundial, etc).</p>
<p>Alguns exemplos de fontes de dados oficiais:</p>
<ul>
<li>World Development Indicators do Banco Mundial- <a href="https://databank.worldbank.org/" class="uri">https://databank.worldbank.org/</a></li>
<li>Eurostat - <a href="https://ec.europa.eu/eurostat" class="uri">https://ec.europa.eu/eurostat</a></li>
<li>INE (Instituto Nacional de Estatística) - <a href="https://www.ine.pt/" class="uri">https://www.ine.pt/</a></li>
<li>Banco de Portugal - <a href="https://bpstat.bportugal.pt/" class="uri">https://bpstat.bportugal.pt/</a></li>
</ul>
<p>O processo para obter dados é relativamente semelhantes entre as várias fontes oficiais, mesmo sem um link direto. Esta costuma ser padrão:</p>
<ol type="1">
<li>Aceder ao site genérico</li>
<li>Procurar o separador ou secção “Dados” / “Estatísticas”</li>
<li>Selecionar o conjunto de dados através do esquema em árvore ou por temas</li>
<li>Selecionar amostra e horizonte temporal</li>
<li>Seguir as instruções para download ou visualização</li>
</ol>
<p>Dependendo da fontes dos dados, pode ser possível recolher várias variáveis em simultâneo ou apenas uma. No caso do segundo é necessário juntar os dados (próxima secção) através de um identificador comum. Este identificador deve ser único para cada observação e deve estar presente em todos os conjuntos de dados que pretendemos combinar. O identificar pode ser uma ou mais colunas. Para séries temporais é a colunas de tempo (ano, mês, etc) e para dados em painel são as colunas de identificação das entidades (exemplo: país, região, empresa, etc) e de tempo (ano, mês, etc).</p>
<p>É muito importante perceber se a fonte dos dados é fidedigna. Por vezes também é necessário analsiar a metodologia de recolha ou cálculo de uma determinada variável. Por exemplo nonaco mundial quando recolhemos uma variável e que por</p>
</section>
<section id="sec-preparar-dados" class="level2">
<h2 class="anchored" data-anchor-id="sec-preparar-dados">Preparar os dados</h2>
<p>Carregar o <code>package</code> <code>dplyr</code> ou o <code>tidyverse</code>. O <code>tidyverse</code> é um conjunto de packages, como <code>ggplot2</code>, <code>dplyr</code> e o <code>tidyr</code> que é utilizado dinamizar ou anular a dinamização de colunas. Mais informação do package <code>tidyr</code> <a href="https://tidyr.tidyverse.org/">aqui</a>. Mais informação acerca do <code>package</code> dplyr <a href="https://rstudio.github.io/cheatsheets/data-transformation.pdf">aqui</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#manipular dados</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="recolher-dados" class="level3">
<h3 class="anchored" data-anchor-id="recolher-dados">Recolher dados</h3>
<p>Para este exemplo vamos utilizar os do WDI para Portugal, Espanha e France com o hironte temporal 1960-2024.</p>
<p>As variáveis selecionais são:</p>
<table class="caption-top table">
<caption>Tabela 4: Indicadores a recolher do WDI</caption>
<colgroup>
<col style="width: 76%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Indicador</th>
<th>Código</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GDP (constant LCU)</td>
<td>NY.GDP.MKTP.KN</td>
</tr>
<tr class="even">
<td>GDP (current LCU)</td>
<td>NY.GDP.MKTP.CN</td>
</tr>
<tr class="odd">
<td>GDP deflator (base year varies by country)</td>
<td>NY.GDP.DEFL.ZS</td>
</tr>
<tr class="even">
<td>Exports of goods and services (constant LCU)</td>
<td>NE.EXP.GNFS.KN</td>
</tr>
<tr class="odd">
<td>Imports of goods and services (constant LCU)</td>
<td>NE.IMP.GNFS.KN</td>
</tr>
<tr class="even">
<td>Trade (% of GDP)</td>
<td>NE.TRD.GNFS.ZS</td>
</tr>
<tr class="odd">
<td>Population, total</td>
<td>SP.POP.TOTL</td>
</tr>
</tbody>
</table>
<p>LCU significa “Local Currency Unit” que neste caso são Euros. Podemos aceder ao site <a href="https://databank.worldbank.org/" class="uri">https://databank.worldbank.org/</a> e selecionar os dados ou utilizar o package <code>WDI</code>. Para este exemplo vamos recolher os dados através do package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#limpar ambiente</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#carregar biblioteca</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WDI)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> WDI<span class="sc">::</span><span class="fu">WDI</span>(<span class="at">country =</span> <span class="fu">c</span>(<span class="st">"PT"</span>, <span class="st">"ES"</span>, <span class="st">"FR"</span>), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">indicator =</span> <span class="fu">c</span>(<span class="st">"NY.GDP.MKTP.KN"</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">"NY.GDP.MKTP.CN"</span>, <span class="st">"NY.GDP.DEFL.ZS"</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">"NE.EXP.GNFS.KN"</span>, <span class="st">"NE.IMP.GNFS.KN"</span>, </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">"NE.TRD.GNFS.ZS"</span>, <span class="st">"SP.POP.TOTL"</span>), </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="dv">1960</span>, <span class="at">end =</span> <span class="dv">2024</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="limpeza-de-dados" class="level3">
<h3 class="anchored" data-anchor-id="limpeza-de-dados">Limpeza de dados</h3>
<p>Os dados já estão num formato de dados em Painel. Contudo existem algumas inconsistências que precisam de ser tratadas. Por exemplo o nome das colunas é o código e não o nome do indicador ou uma abreviatura. Existem também algumas colunas que não têm interesse como a coluna <code>iso2c</code> e <code>iso3c</code> que contém os códigos dos países.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tendo isto em conta vamos alterar o nome das colunas de acordo com:</p>
<table class="caption-top table">
<caption>Tabela 5: abreviaturas dos indicadores do WDI</caption>
<thead>
<tr class="header">
<th>Código</th>
<th>Abreviatura</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>NY.GDP.MKTP.KN</td>
<td>gdp</td>
</tr>
<tr class="even">
<td>NY.GDP.MKTP.CN</td>
<td>gdp_c</td>
</tr>
<tr class="odd">
<td>NY.GDP.DEFL.ZS</td>
<td>deflator</td>
</tr>
<tr class="even">
<td>NE.EXP.GNFS.KN</td>
<td>x</td>
</tr>
<tr class="odd">
<td>NE.IMP.GNFS.KN</td>
<td>m</td>
</tr>
<tr class="even">
<td>NE.TRD.GNFS.ZS</td>
<td>trade</td>
</tr>
<tr class="odd">
<td>SP.POP.TOTL</td>
<td>pop</td>
</tr>
</tbody>
</table>
<p>E também remover as colunas <code>iso2c</code> e <code>iso3c</code>. Existe várias formas de de remover colunas no R, como por exemplo utilizando a função <code>select</code> do <code>dplyr</code>. Praa alterar os nomes das variáveis vamos utilizar a função <code>rename</code>. Podemos fazer em separado ou no mesmo bloco de código. Para isso vamos utilizar o pipe operator. O Pipe operator <code>%&gt;%</code> - then, ou <code>|&gt;</code> é utilizado para encadear várias funções. Mais informação <a href="https://r4ds.had.co.nz/pipes.html">aqui</a>. No R-Studio é possível utilizar o atalho <code>Ctrl+Shift+M</code> para inserir o pipe operator.</p>
<p>Para este exemplo vamos escrever o nome do conjunto do novo conjunto de dados e os dados que vamos utilizar. Se pretendermos manter os dados originais e acrescentar um novo data frame, temos de atribuit um novo nome. Por exemplo <code>dados1 &lt;- dados</code> ou <code>dados &lt;- dados</code> para manter o original e criar um novo com as alterações.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp =</span> NY.GDP.MKTP.KN,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdp_c =</span> NY.GDP.MKTP.CN,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">deflator =</span> NY.GDP.DEFL.ZS,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> NE.EXP.GNFS.KN,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> NE.IMP.GNFS.KN,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">trade =</span> NE.TRD.GNFS.ZS,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop =</span> SP.POP.TOTL</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>iso2c, <span class="sc">-</span>iso3c)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como utilizamos o <code>|&gt;</code> não é necessário escrever repetidamente o nome do data frame como no R base. A função <code>rename()</code> permite alterar os nomes das colunas, enquanto a função <code>select()</code> permite escolher quais colunas manter. Neste caso como eram menos colunas para retirar utilizamos o <code>-</code> antes do nome da coluna que pretendemos excluir.</p>
<p>Para vermos o número de observações total utilizamos a função <code>summarise()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    n
1 195</code></pre>
</div>
</div>
<p>Para obter o nº de valores únicos da colunas, por exemplo para ver o número de ano por país ou número de países utilizamos a função <code>n_distinct()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(year),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">n_distinct</span>(country))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n_distinct(year) n_distinct(country)
1               65                   3</code></pre>
</div>
</div>
<p>Portanto temos 65 anos e 3 países. Para obter uma visão geral dos dados podemos utilizar a função <code>summary</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country               year           gdp                gdp_c          
 Length:195         Min.   :1960   Min.   :3.556e+10   Min.   :4.747e+08  
 Class :character   1st Qu.:1976   1st Qu.:1.973e+11   1st Qu.:5.313e+10  
 Mode  :character   Median :1992   Median :6.198e+11   Median :1.955e+11  
                    Mean   :1992   Mean   :8.330e+11   Mean   :5.866e+11  
                    3rd Qu.:2008   3rd Qu.:1.231e+12   3rd Qu.:1.056e+12  
                    Max.   :2024   Max.   :2.595e+12   Max.   :2.921e+12  
                                                                          
    deflator             x                   m                 trade       
 Min.   :  1.335   Min.   :7.659e+09   Min.   :8.150e+09   Min.   : 25.80  
 1st Qu.: 12.658   1st Qu.:4.383e+10   1st Qu.:4.467e+10   1st Qu.: 41.56  
 Median : 58.254   Median :9.917e+10   Median :1.045e+11   Median : 54.24  
 Mean   : 52.491   Mean   :2.072e+11   Mean   :2.030e+11   Mean   : 52.85  
 3rd Qu.: 87.373   3rd Qu.:3.161e+11   3rd Qu.:3.178e+11   3rd Qu.: 63.20  
 Max.   :120.101   Max.   :8.244e+11   Max.   :8.297e+11   Max.   :101.36  
                   NA's   :20          NA's   :20          NA's   :20      
      pop          
 Min.   : 8630430  
 1st Qu.:10381892  
 Median :39157685  
 Mean   :36197859  
 3rd Qu.:54117618  
 Max.   :68516699  
                   </code></pre>
</div>
</div>
<p>Com isto, conseguimos obter estatísticas descritivas para cada variável bem como o número de observações em falta (NA’s) nas variáveis <code>x</code>, <code>m</code> e <code>trade</code>.</p>
<p>Com a função <code>filter()</code> podemos filtrar por linhas em função dos valores NA’s para uma das variáveis e conseguir preceber quais são os anos com observações em falta. Para identificar os anos em que existem NA’s utilizamos a função <code>is.na()</code> para cada variável. Posteriormente, a função <code>distinct()</code> permite obter os anos únicos com observações em falta. Não utilizamos o <code>&lt;-</code> pois não pretendemos guardar os dados filtrados, apenas visualizar os anos com observações em falta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(x) <span class="sc">|</span> <span class="fu">is.na</span>(m) <span class="sc">|</span> <span class="fu">is.na</span>(trade)) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year
1  1960
2  1961
3  1962
4  1963
5  1964
6  1965
7  1966
8  1967
9  1968
10 1969</code></pre>
</div>
</div>
<p>Conseguimos perceber que os anos em falta são de 1960 a 1969. Por isso, com a função <code>filter()</code> vamos filtar os dados para excluir esse período, ou seja, vamos manter apenas os anos a partir de 1970.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> dados <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1970</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country               year           gdp                gdp_c          
 Length:165         Min.   :1970   Min.   :6.572e+10   Min.   :1.163e+09  
 Class :character   1st Qu.:1983   1st Qu.:2.010e+11   1st Qu.:1.196e+11  
 Mode  :character   Median :1997   Median :8.116e+11   Median :3.042e+11  
                    Mean   :1997   Mean   :9.269e+11   Mean   :6.882e+11  
                    3rd Qu.:2011   3rd Qu.:1.313e+12   3rd Qu.:1.121e+12  
                    Max.   :2024   Max.   :2.595e+12   Max.   :2.921e+12  
    deflator             x                   m                 trade       
 Min.   :  1.769   Min.   :7.659e+09   Min.   :8.150e+09   Min.   : 25.85  
 1st Qu.: 29.897   1st Qu.:4.676e+10   1st Qu.:4.500e+10   1st Qu.: 43.21  
 Median : 68.291   Median :1.150e+11   Median :1.168e+11   Median : 55.13  
 Mean   : 61.050   Mean   :2.169e+11   Mean   :2.124e+11   Mean   : 54.41  
 3rd Qu.: 90.606   3rd Qu.:3.273e+11   3rd Qu.:3.199e+11   3rd Qu.: 63.34  
 Max.   :120.101   Max.   :8.244e+11   Max.   :8.297e+11   Max.   :101.36  
      pop          
 Min.   : 8630430  
 1st Qu.:10434332  
 Median :40057389  
 Mean   :37304185  
 3rd Qu.:56108330  
 Max.   :68516699  </code></pre>
</div>
</div>
<p>Assim obtivemos um painel balanceado. O mesmo procedimento pode ser aplicado a outras estruturas de dados. Outra forma poderia ser utilizar a função <code>na.omit()</code>. Existem várias formas de lidar com os valores em falta que vão para além do objetivo deste livro. Alguns exemplos são a imputação de valores, a utilização de modelos de previsão ou a exclusão de variáveis.</p>
</section>
</section>
<section id="sec-calculos" class="level2">
<h2 class="anchored" data-anchor-id="sec-calculos">Cálculos</h2>
<p>Nesta secção vamos utilizar os dados do ficheiro <code>exemplo_dados.xlsx</code> de um repositório do GitHub.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># link dos dados</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/tiagolafonso/Files_Intro_Applied_Econometrics/main/exemplo_dados.xlsx"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#obter dados</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">GET</span>(url, <span class="fu">write_disk</span>(tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">".xlsx"</span>), </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transformar dados</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(tf)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#remover objetos</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(url,tf)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#ver o nome das colunas</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wdi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Time"     "gdp"      "deflator" "x"        "m"        "trade"    "pop"     </code></pre>
</div>
</div>
<p>Para efetuar cálculos com os dados, podemos utilizar a função <code>mutate()</code>para adicionar novas colunas ao data frame. Por exemplo, calcular o PIB per capita:</p>
<p><span class="math display">\[
gdppc_t = \frac{gdp_t}{pop_t}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">gdp_pc =</span> gdp <span class="sc">/</span> pop)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>wdi <span class="sc">|&gt;</span> <span class="fu">select</span>(Time, gdp_pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 2
    Time gdp_pc
   &lt;dbl&gt;  &lt;dbl&gt;
 1  1970   134.
 2  1971   151.
 3  1972   176.
 4  1973   214.
 5  1974   253.
 6  1975   271.
 7  1976   328.
 8  1977   433.
 9  1978   539.
10  1979   672.
# ℹ 45 more rows</code></pre>
</div>
</div>
<p>Em econometria as variáveis <em>per capita</em> são úteis para comparar indicadores económicos entre diferentes unidades (países, regiões, etc.) ao longo do tempo, controlando o efeito do tamanho da população.</p>
<p>Variação anual do PIB em unidades ou primeira diferença do PIB de ordem 1:</p>
<p><span class="math display">\[
\Delta gdp_t = gdp_t - gdp_{t-1}
\]</span></p>
<p>e no <code>R</code> por:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">d_gdp =</span> gdp <span class="sc">-</span> <span class="fu">lag</span>(gdp))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>wdi <span class="sc">|&gt;</span> <span class="fu">select</span>(Time, gdp, d_gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 3
    Time        gdp      d_gdp
   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1  1970 1162721000         NA
 2  1971 1302027000  139306000
 3  1972 1516157000  214130000
 4  1973 1845576000  329419000
 5  1974 2218820000  373244000
 6  1975 2466820000  248000000
 7  1976 3066191000  599371000
 8  1977 4092805000 1026614000
 9  1978 5148485000 1055680000
10  1979 6495968000 1347483000
# ℹ 45 more rows</code></pre>
</div>
</div>
<p>A função <code>lag()</code> é utilizada para obter o desfasamento de uma variável. A função tem vários argumentos que permitem ajustar o número de períodos a desfasar. Por exemplo para 12 períodos (calcular a variação homóloga de uma variável mensal) a função seria <code>lag(nome_variável,12)</code>.</p>
<p>A variação percentual do PIB é dada por:</p>
<p><span class="math display">\[
\Delta gdp_t = \frac{gdp_t - gdp_{t-1}}{gdp_{t-1}}
\]</span></p>
<p>ou com logaritmos:</p>
<p><span class="math display">\[
\Delta lgdp_t = ln(gdp_t) - ln(gdp_{t-1})
\]</span></p>
<p>O logarítmo de uma variável é frequentemente utilizado para linearizar relações não lineares e para estabilizar a variância. Para calcular o logarítmo da variável <code>gdp</code>(<span class="math inline">\(lgdp_t=ln(gdp)_t\)</span>) por exemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ln_gdp =</span> <span class="fu">log</span>(gdp))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>wdi <span class="sc">|&gt;</span> <span class="fu">select</span>(Time, gdp, d_gdp, ln_gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 4
    Time        gdp      d_gdp ln_gdp
   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
 1  1970 1162721000         NA   20.9
 2  1971 1302027000  139306000   21.0
 3  1972 1516157000  214130000   21.1
 4  1973 1845576000  329419000   21.3
 5  1974 2218820000  373244000   21.5
 6  1975 2466820000  248000000   21.6
 7  1976 3066191000  599371000   21.8
 8  1977 4092805000 1026614000   22.1
 9  1978 5148485000 1055680000   22.4
10  1979 6495968000 1347483000   22.6
# ℹ 45 more rows</code></pre>
</div>
</div>
<p>No <code>R</code> a função <code>log()</code> é utilizada para calcular o logaritmo natural. Para calcular o logaritmo de base 10 é necessário utilizar mais um argumento da função <code>log(gdp,base=10)</code> ou <code>log10()</code>.</p>
<p>Também é possível efetuar o cálculo do logaritmo e das diferneças no mesmo bloco de código dentro da função <code>mutate()</code> e separados por vírgula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ln_gdp =</span> <span class="fu">log</span>(gdp),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">d_lgdp =</span> ln_gdp <span class="sc">-</span> <span class="fu">lag</span>(ln_gdp))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>wdi <span class="sc">|&gt;</span> <span class="fu">select</span>(Time, gdp, d_gdp, ln_gdp, d_lgdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 5
    Time        gdp      d_gdp ln_gdp d_lgdp
   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1  1970 1162721000         NA   20.9 NA    
 2  1971 1302027000  139306000   21.0  0.113
 3  1972 1516157000  214130000   21.1  0.152
 4  1973 1845576000  329419000   21.3  0.197
 5  1974 2218820000  373244000   21.5  0.184
 6  1975 2466820000  248000000   21.6  0.106
 7  1976 3066191000  599371000   21.8  0.218
 8  1977 4092805000 1026614000   22.1  0.289
 9  1978 5148485000 1055680000   22.4  0.229
10  1979 6495968000 1347483000   22.6  0.232
# ℹ 45 more rows</code></pre>
</div>
</div>
<p>Nos modelos econométricos são utilizadas variáveis a preços constantes. Isto permite eliminar o efeito da inflação e refletir apenas as variações na quantidade. Enquanto que o PIB nominal por exemplo é o valor total da produção de bens e serviços a preços correntes, o PIB real é o valor total da produção a preços constantes, ajustado pela inflação. O PIB real é calculado utilizando um deflator do PIB, que é um índice de preços que mede a variação dos preços ao longo do tempo.</p>
<p>O PIB a preços constantes é dado por: <span class="math display">\[
PIB_{real} = \frac{PIB_{nominal}}{Deflator_{PIB}} \times 100
\]</span></p>
<p>De acordo com os dados <code>wdi</code>, a variável <code>gdp</code> representa o PIB a preços correntes e o <code>deflator</code> representa o deflator. Então o PIB real é calculado da seguinte forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">gdp_r =</span> gdp <span class="sc">/</span> deflator <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>wdi <span class="sc">|&gt;</span> <span class="fu">select</span>(Time, gdp, gdp_r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 3
    Time        gdp       gdp_r
   &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1  1970 1162721000 65717083000
 2  1971 1302027000 70075211000
 3  1972 1516157000 75692227000
 4  1973 1845576000 84170265000
 5  1974 2218820000 85132214000
 6  1975 2466820000 81430979000
 7  1976 3066191000 87049905000
 8  1977 4092805000 91926960000
 9  1978 5148485000 94515592000
10  1979 6495968000 99845267000
# ℹ 45 more rows</code></pre>
</div>
</div>
<p>O ano base do Deflator é 2020. Por isso, o PIB real é a preços 2020. Por vezes pode ser útil ou até obrigatório calcular o PIB a preços base de anos diferentes, por exemplo utilizar variáveis de diferentes bases de dados. Para calcular o PIB a preços de 2015, é necessário alterar o ano base do deflator, ou seja:</p>
<p><span class="math display">\[
Deflator_{base2015} = \frac{Deflator_{t}}{Deflator_{2015}} \times 100
\]</span></p>
<p>Por isso é necessário isolar o deflator de 2015 e dividir todas as observações do deflator por esse valor. No <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">deflator_2015 =</span> deflator <span class="sc">/</span> deflator[Time <span class="sc">==</span> <span class="dv">2015</span>] <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O <code>[Time==2015]</code> é utilizado para isolar a linha do deflator para o ano de 2015. Neste caso é obrigatório utilizar o <code>==</code> e não apenas <code>=</code>. Este último é reservado a operações.</p>
<p>Assim, já é possível calcular o PIB a preços de 2015.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gdp_r_2015 =</span> gdp <span class="sc">/</span> deflator_2015 <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-graficos" class="level2">
<h2 class="anchored" data-anchor-id="sec-graficos">Gráficos</h2>
<p>Os gráficos são uma forma de visualizar os dados e de perceber a relação entre as variáveis. Existem vários tipos de gráficos, desde gráficos de barras, gráficos de linhas, gráficos de dispersão, gráficos de caixa, entre outros. O <code>R</code> tem várias funções para criar gráficos, desde as funções base do <code>R</code> até aos <code>packages</code> <code>ggplot2</code> e <code>plotly</code>. O mais utilizado é o <code>ggplot2</code> que permite criar gráficos mais complexos e com mais opções de personalização, enquanto o <code>plotly</code> permite criar gráficos interativos. Já os gráficos base do <code>R</code> são mais simples e menos personalizáveis, são utilizados para visualizações mais rápidas.</p>
<section id="preparar-dados" class="level3">
<h3 class="anchored" data-anchor-id="preparar-dados">Preparar dados</h3>
<p>Preparar os dados do ficheiro <code>wdi_data2.xlsx</code> para utilização com modelo econométricos. Este ficheiro é diferentes dos anteriores, pois contém dados em formato longo. No formato longo cada linha representa uma observação única, com variáveis em colunas. Enquanto que no formato largo, cada linha representa uma unidade de observação, com várias colunas para diferentes variáveis. Em econometria os dados são utilizado no formato largo.</p>
<p>Carregar packages necessários:</p>
<div class="cell" data-ouput="false">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#libraries</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>O <code>package</code> <code>tidyverse</code> é um conjunto de packages, como <code>ggplot2</code>, <code>dplyr</code> e o <code>tidyr</code> que é utilizado dinamizar ou anular a dinamização de colunas. Mais informação do package <code>tidyr</code> <a href="https://tidyr.tidyverse.org/">aqui</a>.</p>
<p>Importar ficheiro <code>wdi_data2.xlsx</code> da pasta diretório</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"wdi_data2.xlsx"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wdi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Country_Name Country_Code Series_Name             Series_Code    year    Value
  &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;                   &lt;chr&gt;          &lt;chr&gt;   &lt;dbl&gt;
1 Portugal     PRT          GDP (constant 2015 US$) NY.GDP.MKTP.KD 1974… 8.61e10
2 Portugal     PRT          GDP (constant 2015 US$) NY.GDP.MKTP.KD 1975… 8.24e10
3 Portugal     PRT          GDP (constant 2015 US$) NY.GDP.MKTP.KD 1976… 8.81e10
4 Portugal     PRT          GDP (constant 2015 US$) NY.GDP.MKTP.KD 1977… 9.30e10
5 Portugal     PRT          GDP (constant 2015 US$) NY.GDP.MKTP.KD 1978… 9.56e10
6 Portugal     PRT          GDP (constant 2015 US$) NY.GDP.MKTP.KD 1979… 1.01e11</code></pre>
</div>
</div>
<p>Limpar dados:</p>
<ol type="1">
<li><p>Função <code>select</code> para excluir coluna <code>Series_Code</code></p></li>
<li><p>Função <code>mutate</code> acrescentar colunas:</p>
<ol type="1">
<li><p><code>substr</code> extrair os primeiros 4 caracteres da coluna <code>year</code></p></li>
<li><p><code>as.numeric</code> converter coluna <code>year</code> para formato número inteiro.</p></li>
</ol></li>
<li><p>Função <code>pivot_wider</code> para dinamizar a coluna <code>Series_Name</code> pelo valor da coluna <code>Value</code></p></li>
<li><p>Função <code>filter</code> para balancear os dados, uma vez que a coluna <code>C02 emissions (kt)</code> apenas tem dados de 1990-&gt;2020</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>wdi2 <span class="ot">&lt;-</span> wdi <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Series_Code)<span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">year=</span><span class="fu">substr</span>(year,<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">year=</span><span class="fu">as.numeric</span>(year)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                   ) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Series_Name,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">values_from =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1990</span> <span class="sc">&amp;</span> year<span class="sc">&lt;=</span><span class="dv">2020</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wdi2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Country_Name Country_Code  year `GDP (constant 2015 US$)` `CO2 emissions (kt)`
  &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;                     &lt;dbl&gt;                &lt;dbl&gt;
1 Portugal     PRT           1990             145478331657.               41069.
2 Portugal     PRT           1991             151833125542.               42768.
3 Portugal     PRT           1992             153487311625.               46774 
4 Portugal     PRT           1993             150351141408.               45793.
5 Portugal     PRT           1994             151801786241.               47303.
6 Portugal     PRT           1995             158303123480.               50693.</code></pre>
</div>
</div>
<p>Alterar o nome das colunas de <code>GDP (constant 2015 US$)</code> para <code>GDP</code> e <code>CO2 emissions (kt)</code> para <code>CO2</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wdi2 <span class="ot">&lt;-</span> wdi2 <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">GDP=</span><span class="st">`</span><span class="at">GDP (constant 2015 US$)</span><span class="st">`</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">CO2=</span><span class="st">`</span><span class="at">CO2 emissions (kt)</span><span class="st">`</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wdi2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Country_Name Country_Code  year           GDP    CO2
  &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 Portugal     PRT           1990 145478331657. 41069.
2 Portugal     PRT           1991 151833125542. 42768.
3 Portugal     PRT           1992 153487311625. 46774 
4 Portugal     PRT           1993 150351141408. 45793.
5 Portugal     PRT           1994 151801786241. 47303.
6 Portugal     PRT           1995 158303123480. 50693.</code></pre>
</div>
</div>
</section>
<section id="gráficos-com-a-função-plot" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-com-a-função-plot">Gráficos com a função <code>plot</code></h3>
<p>A função <code>plot</code> é a função base do <code>R</code> para criar gráficos. Para criar um gráfico de dispersão entre as variáveis do dataset <code>wdi2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wdi2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/plot-scatter-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Para criar um gráfico de dispersão entre as variáveis <code>GDP</code> e <code>CO2</code> do <em>data frame</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wdi2<span class="sc">$</span>GDP,wdi2<span class="sc">$</span>CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/plot-scatter2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráficos-com-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-com-ggplot2">Gráficos com <code>ggplot2</code></h3>
<p>O mesmo gráfico com <code>ggplot2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2))<span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A sintáxe da função <code>ggplot</code> é <code>ggplot(data,aes(x=variável_x,y=variável_y))</code> e para adicionar um gráfico de dispersão é necessário adicionar a função <code>geom_point()</code>. Funciona por camadas, ou seja, é possível adicionar várias camadas ao gráfico. Também é possível adicionar um título ao gráfico com a função <code>labs(title="Título")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2))<span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Dispersão GDP vs CO2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Para alterar a cor dos pontos é necessário adicionar o argumento <code>color</code> à função <code>aes</code>. Para alterar a cor dos pontos por <code>Country_Name</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2,<span class="at">color=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Dispersão GDP vs CO2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Alterar os título dos eixos <code>x</code> e <code>y</code> para <code>GDP (2015 US$)</code> e <code>CO2 (kt)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2,<span class="at">color=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Dispersão GDP vs CO2"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"GDP (2015 US$)"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"CO2 (kt)"</span>)<span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A função <code>theme</code> permite alterar o tema do gráfico, neste caso o título do gráfico é centrado.</p>
<p>Para além disso também é possível adicionar temas pré-definidos ao gráfico, por exemplo o tema <code>theme_minimal</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2,<span class="at">color=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Dispersão GDP vs CO2"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"GDP (2015 US$)"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"CO2 (kt)"</span>)<span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Também é possível adicionar outras camadas, como por exemplo uma linha de regressão linear com a função <code>geom_smooth</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2,<span class="at">color=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Dispersão GDP vs CO2"</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"GDP (2015 US$)"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"CO2 (kt)"</span>)<span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>e agora um polinómio de 2º grau:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>GDP,<span class="at">y=</span>CO2,<span class="at">color=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>,<span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">formula =</span> y<span class="sc">~</span><span class="fu">poly</span>(x,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Dispersão GDP vs CO2"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"GDP (2015 US$)"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"CO2 (kt)"</span>)<span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-scatter-ggplot7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Em suma, a função <code>ggplot</code> começa com os dados, e com na função <code>aes</code> são definidos os eixos <code>x</code> e <code>y</code> e a cor dos pontos.</p>
<p>A primeira camada do gráfico é a função <code>geom_point</code> que cria um gráfico de dispersão, a segunda camada é a função <code>geom_smooth</code> que cria uma linha de regressão linear, a terceira camada é a função <code>labs</code> que adiciona um título ao gráfico e altera o nome dos eixos <code>x</code> e <code>y</code>, a quarta camada é a função <code>theme</code> que altera o tema do gráfico. Claro que existem outras funções que podem ser adicionadas ao gráfico e serão abordadas ao longo das secções.</p>
</section>
<section id="gráficos-com-plotly" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-com-plotly">Gráficos com <code>plotly</code></h3>
<p>O <code>package</code> <code>plotly</code> permite criar gráficos interativos. Para criar um gráfico de dispersão interativo entre as variáveis <code>GDP</code> e <code>CO2</code> do <em>data frame</em> <code>wdi2</code>. Preparar os dados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#limpar ambiente</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#carregar bibliotecas</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#importar ficheiro de dados</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>wdi <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"wdi_data2.xlsx"</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">#limpar data frame</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>wdi2 <span class="ot">&lt;-</span> wdi <span class="sc">|&gt;</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Series_Code) <span class="sc">|&gt;</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">year=</span><span class="fu">substr</span>(year,<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">year=</span><span class="fu">as.numeric</span>(year)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                   )  <span class="sc">|&gt;</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Series_Name,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">values_from =</span> Value)  <span class="sc">|&gt;</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(year<span class="sc">&gt;=</span><span class="dv">1990</span> <span class="sc">&amp;</span> year<span class="sc">&lt;=</span><span class="dv">2020</span>)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co">#alterar o nome das colunas</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>wdi2 <span class="ot">&lt;-</span> wdi2  <span class="sc">|&gt;</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">GDP=</span><span class="st">`</span><span class="at">GDP (constant 2015 US$)</span><span class="st">`</span>,</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">CO2=</span><span class="st">`</span><span class="at">CO2 emissions (kt)</span><span class="st">`</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gráfico de dispersão com <code>plotly</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(wdi2,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="sc">~</span>GDP,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="sc">~</span>CO2,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="sc">~</span>Country_Name,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">"scatter"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode=</span><span class="st">"markers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7c4034d6c0c6c16fd07d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7c4034d6c0c6c16fd07d">{"x":{"visdat":{"97b42a5f4383":["function () ","plotlyVisDat"]},"cur_data":"97b42a5f4383","attrs":{"97b42a5f4383":{"x":{},"y":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"GDP"},"yaxis":{"domain":[0,1],"automargin":true,"title":"CO2"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"y":[356297.90000000002,380691.29999999999,368655.70000000001,349524.59999999998,344475.40000000002,352283.09999999998,367959.59999999998,359140.5,381182.29999999999,375003.59999999998,373235.79999999999,376860.29999999999,371167.20000000001,376838.70000000001,377948.5,380816.09999999998,371741,363052.20000000001,358211.20000000001,343882.5,347940.09999999998,335031.90000000002,338315.40000000002,338453.09999999998,306017.40000000002,311175.40000000002,313835.20000000001,317721.20000000001,306948.40000000002,300561.59999999998,267154.70000000001],"mode":"markers","type":"scatter","name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"y":[41068.599999999999,42767.699999999997,46774,45792.800000000003,47302.900000000001,50693.199999999997,48742.5,50931.599999999999,55600.599999999999,62207.599999999999,61661.199999999997,61383.599999999999,65604.899999999994,60523.599999999999,62128.800000000003,65473.800000000003,60448,58797.599999999999,56844.400000000001,56299.599999999999,50937.300000000003,49867.900000000001,48220.300000000003,46555.199999999997,45931.099999999999,49851.900000000001,48695.199999999997,53272.699999999997,49461.199999999997,44564.699999999997,38973.5],"mode":"markers","type":"scatter","name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"y":[214950.60000000001,222099.70000000001,232369.60000000001,218079.79999999999,228452.70000000001,240567.29999999999,230113.20000000001,248603.10000000001,256215.5,278300.5,293314.29999999999,294786.79999999999,312753.29999999999,318657.70000000001,335560.29999999999,350499.79999999999,341776.29999999999,354683.09999999998,324274.20000000001,288131.20000000001,274140.59999999998,275470.09999999998,270280.40000000002,243794.89999999999,241979.89999999999,257251.20000000001,248252.10000000001,264723.70000000001,258373.20000000001,241886.5,202705.79999999999],"mode":"markers","type":"scatter","name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>A função <code>plotly_ly</code> começa com os dados, e com <code>x</code> e <code>y</code> são definidos os eixos <code>x</code> e <code>y</code> e a cor dos pontos. O argumento <code>type</code> define o tipo de gráfico, neste caso <code>scatter</code> e o argumento <code>mode</code> define o tipo de marcador, neste caso <code>markers</code>.</p>
</section>
<section id="gráficos-de-barras" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-de-barras">Gráficos de barras</h3>
<p>Para criar um gráfico de barras com a função <code>barplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(wdi2<span class="sc">$</span>GDP,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg=</span><span class="fu">paste</span>(wdi2<span class="sc">$</span>Country_Name, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                        wdi2<span class="sc">$</span>year, <span class="at">sep=</span><span class="st">"-"</span>),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">las=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/barplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>ggplot2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>Country_Name,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span>GDP,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Barras GDP por País e Ano"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"País"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"GDP (2015 US$)"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill=</span><span class="st">"País"</span>)<span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-barplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>plotly</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(wdi2,<span class="at">x=</span><span class="sc">~</span>Country_Name,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">y=</span><span class="sc">~</span>GDP,<span class="at">type=</span><span class="st">"bar"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="sc">~</span>Country_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9a3944d691d63543265b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9a3944d691d63543265b">{"x":{"visdat":{"97b4416f1fbe":["function () ","plotlyVisDat"]},"cur_data":"97b4416f1fbe","attrs":{"97b4416f1fbe":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Country_Name","type":"category","categoryorder":"array","categoryarray":["France","Portugal","Spain"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"GDP"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France"],"y":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"type":"bar","name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal"],"y":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"type":"bar","name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain"],"y":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"type":"bar","name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="gráficos-de-linhas" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-de-linhas">Gráficos de linhas</h3>
<p>Para criar um gráfico de linhas com a função <code>ggplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,<span class="fu">aes</span>(<span class="at">x=</span>year,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span>GDP,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Linhas GDP por Ano"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"Ano"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"GDP (2015 US$)"</span>)<span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-line-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>plotly</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(wdi2,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="sc">~</span>year,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span><span class="sc">~</span>GDP,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">type=</span><span class="st">"scatter"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">mode=</span><span class="st">"lines"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">color=</span><span class="sc">~</span>Country_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a1400e65171b7edc9fc6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a1400e65171b7edc9fc6">{"x":{"visdat":{"97b473003ef6":["function () ","plotlyVisDat"]},"cur_data":"97b473003ef6","attrs":{"97b473003ef6":{"x":{},"y":{},"mode":"lines","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"GDP"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],"y":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"mode":"lines","type":"scatter","name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],"y":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"mode":"lines","type":"scatter","name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020],"y":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"mode":"lines","type":"scatter","name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="gráficos-de-box-plot" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-de-box-plot">Gráficos de box plot</h3>
<p>Para criar um gráfico de caixa com a função <code>boxplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(wdi2<span class="sc">$</span>GDP<span class="sc">~</span>wdi2<span class="sc">$</span>Country_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/boxplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>ggplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>Country_Name,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span>GDP,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill=</span>Country_Name)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>        )<span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Caixa GDP por País"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">x=</span><span class="st">"País"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y=</span><span class="st">"GDP (2015 US$)"</span>)<span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-boxplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>plotly</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(wdi2,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="sc">~</span>Country_Name,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="sc">~</span>GDP,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">"box"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="sc">~</span>Country_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6d867a6b5865b3d0da3a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6d867a6b5865b3d0da3a">{"x":{"visdat":{"97b4165b3ab6":["function () ","plotlyVisDat"]},"cur_data":"97b4165b3ab6","attrs":{"97b4165b3ab6":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Country_Name","type":"category","categoryorder":"array","categoryarray":["France","Portugal","Spain"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"GDP"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":["France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France"],"y":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"type":"box","name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":["Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal"],"y":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"type":"box","name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":["Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain"],"y":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"type":"box","name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="gráfico-violino" class="level3">
<h3 class="anchored" data-anchor-id="gráfico-violino">Gráfico violino</h3>
<p>Para criar um gráfico de violino com a função <code>geom_violin</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x=</span>Country_Name,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">y=</span>GDP,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>()<span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Gráfico de Violino GDP por País"</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"País"</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"GDP (2015 US$)"</span>)<span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-violin-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>plotly</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(wdi2,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="sc">~</span>Country_Name,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="sc">~</span>GDP,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">"violin"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="sc">~</span>Country_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a1353cac23ada70a62e4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a1353cac23ada70a62e4">{"x":{"visdat":{"97b448c36244":["function () ","plotlyVisDat"]},"cur_data":"97b448c36244","attrs":{"97b448c36244":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"violin"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Country_Name","type":"category","categoryorder":"array","categoryarray":["France","Portugal","Spain"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"GDP"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":["France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France"],"y":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"type":"violin","name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":["Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal"],"y":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"type":"violin","name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":["Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain"],"y":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"type":"violin","name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Violino e boxplot no mesmo gráfico:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(wdi2,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="sc">~</span>Country_Name,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="sc">~</span>GDP,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">type=</span><span class="st">"violin"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">color=</span><span class="sc">~</span>Country_Name) <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(<span class="at">x=</span><span class="sc">~</span>Country_Name,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="sc">~</span>GDP,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">type=</span><span class="st">"box"</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">boxpoints=</span><span class="st">"all"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">jitter=</span><span class="fl">0.3</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">pointpos=</span><span class="sc">-</span><span class="fl">1.8</span>,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span><span class="sc">~</span>Country_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-39878586aed17f87f05f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-39878586aed17f87f05f">{"x":{"visdat":{"97b46bbc2d50":["function () ","plotlyVisDat"]},"cur_data":"97b46bbc2d50","attrs":{"97b46bbc2d50":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"violin"},"97b46bbc2d50.1":{"x":{},"y":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","boxpoints":"all","jitter":0.29999999999999999,"pointpos":-1.8,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Country_Name","type":"category","categoryorder":"array","categoryarray":["France","Portugal","Spain"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"GDP"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(102,194,165,0.5)","x":["France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France"],"y":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"type":"violin","name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":["Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal"],"y":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"type":"violin","name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":["Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain"],"y":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"type":"violin","name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(102,194,165,0.5)","x":["France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France"],"y":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"type":"box","boxpoints":"all","jitter":0.29999999999999999,"pointpos":-1.8,"name":"France","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(252,141,98,0.5)","x":["Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal"],"y":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"type":"box","boxpoints":"all","jitter":0.29999999999999999,"pointpos":-1.8,"name":"Portugal","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(141,160,203,0.5)","x":["Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain"],"y":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"type":"box","boxpoints":"all","jitter":0.29999999999999999,"pointpos":-1.8,"name":"Spain","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="histograma" class="level3">
<h3 class="anchored" data-anchor-id="histograma">Histograma</h3>
<p>Para criar um histograma com a função <code>hist</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wdi2<span class="sc">$</span>GDP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>ggplot</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wdi2,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>GDP,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span>Country_Name))<span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histograma GDP"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">x=</span><span class="st">"GDP (2015 US$)"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="st">"Frequência"</span>)<span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="capitulo-02-dados-economicos_files/figure-html/ggplot-hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>com a função <code>plotly</code> para os 3 países:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">subplot</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    wdi2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Country_Name<span class="sc">==</span><span class="st">"Portugal"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_ly</span>(<span class="at">x=</span><span class="sc">~</span>GDP,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">type=</span><span class="st">"histogram"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">name=</span><span class="st">"Portugal"</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    wdi2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Country_Name<span class="sc">==</span><span class="st">"Spain"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_ly</span>(<span class="at">x=</span><span class="sc">~</span>GDP,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">type=</span><span class="st">"histogram"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">name=</span><span class="st">"Spain"</span>),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    wdi2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Country_Name<span class="sc">==</span><span class="st">"France"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_ly</span>(<span class="at">x=</span><span class="sc">~</span>GDP,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">type=</span><span class="st">"histogram"</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">name=</span><span class="st">"France"</span>),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrows =</span> <span class="dv">3</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c6994b566ec6acc25b0f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c6994b566ec6acc25b0f">{"x":{"data":[{"x":[145478331657.14844,151833125542.38629,153487311625.17383,150351141407.78827,151801786241.27771,158303123479.59647,163850456044.52731,171061297929.06561,179285861799.30389,186289802829.51129,193398953419.57224,197157995297.65152,198677933649.21207,196829193371.54056,200349947385.1261,201916379874.36826,205197590054.86789,210341031080.27606,211012540457.55612,204424561357.60846,207976694614.76666,204449067168.8237,196153968235.58972,194344164093.78894,195883739714.00067,199394066525.44012,203420800578.6405,210553436228.05728,216552789892.19321,222362381347.61975,203905155102.50415],"name":"Portugal","type":"histogram","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[737305660791.84119,756077467226.83582,763103054853.53931,755231709959.59595,773230356774.81006,794552137824.60889,815691686929.68701,845892627812.49951,883053543058.20264,922707533769.14026,971112252648.43713,1009306124395.3121,1036869753137.109,1067788548860.1559,1101132739762.1089,1141347034482.812,1188172916518.7495,1231003442635.5464,1241923268505.0774,1195188366526.1711,1197135561649.218,1187386271879.2961,1152252436684.7649,1136082395816.7961,1151939554049.6086,1196156971279.6868,1232493518447.6555,1269169576560.1555,1298163367417.968,1323918490148.0461,1176072568933.593],"name":"Spain","type":"histogram","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[1661090955411.7024,1678502109603.7661,1705347110174.8438,1694626166709.9827,1734592373238.8289,1771133801947.6677,1796159810500.6975,1838123429815.5334,1904087419529.2537,1969233367607.7419,2046499571261.1829,2087096421588.522,2110796058518.4023,2128171303325.761,2188393293109.3516,2224791087607.9087,2279283420792.2778,2334550031985.4214,2340501872979.0425,2273251909006.5205,2317567536989.1377,2368384855035.1729,2375801091055.5366,2389493466482.8091,2412341398046.8433,2439188643162.4985,2465909086487.9365,2522413420333.7812,2569458097202.2368,2616812485718.0073,2419492808873.395],"name":"France","type":"histogram","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"anchor":"y2"},"xaxis3":{"domain":[0,1],"automargin":true,"anchor":"y3"},"yaxis3":{"domain":[0,0.31333333333333335],"automargin":true,"anchor":"x3"},"yaxis2":{"domain":[0.35333333333333339,0.64666666666666672],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0.68666666666666676,1],"automargin":true,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true},"attrs":{"97b453233c6d":{"x":{},"name":"Portugal","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"},"97b427ca1bf4":{"x":{},"name":"Spain","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"},"97b458e36142":{"x":{},"name":"France","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>